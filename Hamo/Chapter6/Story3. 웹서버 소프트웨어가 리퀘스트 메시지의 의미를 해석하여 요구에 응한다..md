# Story3. 웹서버 소프트웨어가 리퀘스트 메시지의 의미를 해석하여 요구에 응한다.
## 조회의 URI를 실제 파일명으로 변환한다.

- 웹 서버의 경우 read에서 받은 데이터의 내용이 HTTP 리퀘스트 메시지가 된다.
    - 그리고 받은 리퀘스트 메시지에 기록되어 있는 내용에 따라 적절한 처리를 실행하여 응답 메시지를 만들고 write 를 통해 이것을 클라이언트에 반송한다는 형태로 작동한다.
- 가장 간단한 것은 GET 메서드와 HTML 문서의 파일명을 나타내는 URI를 기록한 리퀘스트이다.
    - URI에 기록되어 있는 파일을 디스크에서 읽는 것은 아니다.
    - 단순히 URI에 기록되어 있는 경로명의 파일을 읽어오면 디스크의 파일에 전부 액세스할 수 있게 되므로 웹 서버의 디스크가 무방비 상태로 노출되어 위험하기 때문이다.
    - 웹 서버에 공개하는 디렉토리는 실제 디렉토리가 아니라 가상으로 만든 디렉토리이고, 이 가상의 디렉토리 구조에서의 경로명을 URI에 써야 한다.
    - 파일을 읽어올 떄는 가상의 디렉토리와 실제 디렉토리의 대응 관계를 조사하고, 실제 디렉토리의 경로명으로 변환하 후 파일을 읽어 데이터를 반송한다.

## CGI 프로그램을 작동하는 경우

- 프로그램 파일의 이름을 URI에 쓸 수도 있는데 이 경우에는 해당 프로그램을 작동시켜서 프로그램이 출력하는 데이터를 반송한다.
- 웹 서버에서 작동시키는 프로그램은 몇 가지 유형이 있고 각 유형에 따라 구체적인 동작이 달라진다.
- 웹서버에서 프로그램을 작동시키는 경우 프로그램에서 처리하는 데이터를 HTTP의 리퀘스트 메시지 안에 넣어 브라우저에서 웹 서버로 보내는 것이 일반적이다.
    - GET을 사용해서 URI 뒤에 입력 데이터를 내장하는 방법
    - POST를 사용해서 body에 데이터를 내장해서 서버에 보내는 방법
- URI 부분에 쓰여 있는 파일명을 조사하여 이것이 프로그램인지 판단한다.
- 파일이 프로그램인 것을 알고 있으면 웹 서버는 이 프로그램을 작동시키도록 OS에 의뢰한다.
- 리퀘스트 메시지에서 데이터를 추출하여 작동시킨 프로그램에 건네준다.
- 작동시킨 프로그램이 받은 데이터를 처리하여 무언가의 출력 데이터를 웹 서버에 되돌려준다.

## 웹 서버로 수행하는 액세스 제어

- 회원제의 정보 제공 서비스 등에서 특정 사용자에게만 액세스를 허가하는 것과 같은 경우에 액세스 제어를 사용한다.
- 웹 서버에서 설정하는 조건은 주로 다음의 세가지 이다.
    - 클라이언트의 주소
    - 클라이언트의 도메인명
    - 사용자명과 패스워드
    - 이 조건을 데이터 출처가 되는 파일이나 디렉토리와 대응해서 설정한다.
    - 액세스가 허가된 경우에만 파일을 읽거나 프로그램을 실행한다.

## 응답 메시지를 되돌려 보낸다.

- 리퀘스트 메시지에 대해 적절하게 처리하고 처리가 완료되면 응답 메시지를 반송한다.
- 클라이언트가 리퀘스트 메시지를 웹 서버에 보내는 동작과 같다.
