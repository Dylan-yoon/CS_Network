# 웹 서버의 IP 주소를 DNS 서버에 조회한다

브라우저는 HTTP 메시지를 만든 후, OS에 의뢰해서 웹 서버에 메시지를 송신
  - 브라우저는 메시지를 네트워크에 송출하는 기능이 없기 때문
  - OS에 송신을 의뢰하기 위해서는 IP 주소로 상대를 지정해야 하기 때문에, URL에 쓰여진 도메인명을 통해 IP를 조사해야 한다.

### TCP/IP 네트워크
<img width="712" alt="image" src="https://github.com/Dylan-yoon/CS_Network/assets/98260324/00f28df3-53b1-4510-9afd-2fcd915a58fa">

송신 컴퓨터 → 허브 → 라우터 → 허브 → 라우터 → ... → 허브 → 수신처

라우터 → 허브 → 라우터의 과정에서
  1. 라우터에서 다음 라우터를 판단한다.
  2. 다음 라우터로 보내도록 송신 동작을 실행한다.
  3. 허브가 다음 라우터로 메시지를 보낸다.

### IP 주소
IP 주소 = 네트워크 번호 + 호스트 번호
  - 네트워크 번호: 서브넷에 할당
  - 호스트 번호: 컴퓨터에 할당
  - 실제 IP 주소는 32 bit </br>
    <img width="301" alt="image" src="https://github.com/Dylan-yoon/CS_Network/assets/98260324/fae89492-810b-41a2-bfb8-87686f5ff901">
    - 8 bit(1 byte)씩 `.`으로 구분하여 10진수로 표기
    - 넷마스크: 어디까지가 네트워크/호스트 번호인지 알려주는 정보
      - 넷마스크가 1인 부분 = 네트워크 번호, 넷마스크가 0인 부분 = 호스트 번호
      - 호스트 번호 부분이 모두 0인 경우: 서브넷 자체를 나타냄 (예: `10.11.12.0`)
      - 호스트 번호 부분이 모두 1인 경우: 서브넷에 있는 기기 전체에 패킷을 보내는 브로드캐스트를 나타냄 (예: `10.11.12.255`)

### DNS (Domain Name System)
서버명-IP 주소를 대응시키기 위해 주로 사용한다.

DNS 서버에 IP 주소를 조회한다 = DNS 서버에 조회 메시지를 보내고, 반송되는 응답 메시지를 받는다.
  - 네임 리졸루션(name resolution): DNS 원리를 사용해 IP 주소를 조사하는 것
  - 리졸버(resolver): DNS 클라이언트에 해당하는 것. 네임 리졸루션을 실행. Socket 라이브러리에 들어있는 부품화한 프로그램.
  - Socket 라이브러리: OS에 포함되어 있는 네트워크의 기능을 애플리케이션에서 호출하기 위한 부품(프로그램)들을 모아놓은 것

브라우저 등의 애플리케이션 프로그램을 만들 때, 리졸버의 프로그램 이름과 웹 서버의 이름을 쓰면 리졸버를 호출할 수 있다.

### 흐름
1. 리졸버를 호출하면 제어가 리졸버에 넘어간다.
2. 리졸버가 DNS의 사양에 따라서 DNS 서버에 보낼 조회 메시지를 작성한다.
3. 리졸버가 OS에 포함된 프로토콜 스택을 호출회 조회 메시지 송신을 OS에 의뢰한다.
    - 리졸버 자체에는 네트워크 송수신 기능이 없기 때문
    - DNS 서버에 메시지를 보낼 때 DNS 서버의 IP 주소가 필요하지만, TCP/IP 설정 항목으로 컴퓨터에 미리 설정되어 있다.
4. LAN 어댑터를 통해 메시지가 DNS 서브를 향해 송신
5. DNS 서버에서 조회 메시지를 수신하고, 답(IP 주소)을 응답 메시지에 기재해 클라이언트에 반송
6. 응답 메시지는 프로토콜 스택을 경유해 리졸버에 전달
7. 리졸버가 응답 메시지에서 IP 주소를 추출해서 브라우저에서 지정한 메모리 영역에 기록
8. 제어가 애플리케이션에 넘어간다.
9. 브라우저가 웹 서버에 메시지를 보낼 때, 메모리 영역에서 IP 주소를 호출해 HTTP 리퀘스트 메시지와 함께 OS에 전달해 송신을 의뢰
